<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP API: /home/zoe/Mbed Programs/esp_code/mbed-os/connectivity/mbedtls/include/mbedtls/ecdh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('ecdh_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ecdh.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file contains ECDH definitions and functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mbedtls_2include_2mbedtls_2config_8h_source.html">mbedtls/config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h_source.html">mbedtls/ecp.h</a>&quot;</code><br />
</div>
<p><a href="ecdh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <a href="structmbedtls__ecdh__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad99780d37a37e353f51c21bf5119fa1f" id="r_ad99780d37a37e353f51c21bf5119fa1f"><td class="memItemLeft" align="right" valign="top">typedef struct mbedtls_ecdh_context_mbed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad99780d37a37e353f51c21bf5119fa1f">mbedtls_ecdh_context_mbed</a></td></tr>
<tr class="separator:ad99780d37a37e353f51c21bf5119fa1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbeab18d635fc3d2ae9afb941d41f4da" id="r_abbeab18d635fc3d2ae9afb941d41f4da"><td class="memItemLeft" align="right" valign="top">typedef struct mbedtls_ecdh_context&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbeab18d635fc3d2ae9afb941d41f4da">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:abbeab18d635fc3d2ae9afb941d41f4da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <br /></td></tr>
<tr class="separator:abbeab18d635fc3d2ae9afb941d41f4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae5df12f2068df09a102e05e02fb1e39c" id="r_ae5df12f2068df09a102e05e02fb1e39c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> { <a class="el" href="#ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>
, <a class="el" href="#ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>
 }</td></tr>
<tr class="separator:ae5df12f2068df09a102e05e02fb1e39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c17082db89e58cce0bf0731a02a20f6" id="r_a3c17082db89e58cce0bf0731a02a20f6"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c17082db89e58cce0bf0731a02a20f6">mbedtls_ecdh_variant</a> { <a class="el" href="#a3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc">MBEDTLS_ECDH_VARIANT_NONE</a> = 0
, <a class="el" href="#a3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885">MBEDTLS_ECDH_VARIANT_MBEDTLS_2_0</a>
 }</td></tr>
<tr class="separator:a3c17082db89e58cce0bf0731a02a20f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7601b043149f7171a47248b7244a4857" id="r_a7601b043149f7171a47248b7244a4857"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7601b043149f7171a47248b7244a4857">mbedtls_ecdh_can_do</a> (<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> gid)</td></tr>
<tr class="memdesc:a7601b043149f7171a47248b7244a4857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a given group can be used for ECDH.  <br /></td></tr>
<tr class="separator:a7601b043149f7171a47248b7244a4857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403a5d7363b6219a2017b837b665c354" id="r_a403a5d7363b6219a2017b837b665c354"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a403a5d7363b6219a2017b837b665c354">mbedtls_ecdh_gen_public</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a403a5d7363b6219a2017b837b665c354"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an ECDH keypair on an elliptic curve.  <br /></td></tr>
<tr class="separator:a403a5d7363b6219a2017b837b665c354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0670e79f3002a218d6da8c8dee61e1" id="r_aca0670e79f3002a218d6da8c8dee61e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca0670e79f3002a218d6da8c8dee61e1">mbedtls_ecdh_compute_shared</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *z, const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:aca0670e79f3002a218d6da8c8dee61e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the shared secret.  <br /></td></tr>
<tr class="separator:aca0670e79f3002a218d6da8c8dee61e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e787a12f7aae180ab9828303199dca" id="r_a97e787a12f7aae180ab9828303199dca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97e787a12f7aae180ab9828303199dca">mbedtls_ecdh_init</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a97e787a12f7aae180ab9828303199dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an ECDH context.  <br /></td></tr>
<tr class="separator:a97e787a12f7aae180ab9828303199dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296f6ce7b1b8b53d048a6c28ff3420cc" id="r_a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a296f6ce7b1b8b53d048a6c28ff3420cc">mbedtls_ecdh_setup</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> grp_id)</td></tr>
<tr class="memdesc:a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up the ECDH context with the information given.  <br /></td></tr>
<tr class="separator:a296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89cc40dc92fbbaf0275ea9a6184a5e71" id="r_a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89cc40dc92fbbaf0275ea9a6184a5e71">mbedtls_ecdh_free</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function frees a context.  <br /></td></tr>
<tr class="separator:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784e56d5eea12e38374e9ce028692940" id="r_a784e56d5eea12e38374e9ce028692940"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a784e56d5eea12e38374e9ce028692940">mbedtls_ecdh_make_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *<a class="el" href="wsf__trace_8c.html#a631cb00ea94506727e7ab9cdd27cf9cd">buf</a>, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a784e56d5eea12e38374e9ce028692940"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange handshake message.  <br /></td></tr>
<tr class="separator:a784e56d5eea12e38374e9ce028692940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07326ad0017bf6fcfb9f93e43641254" id="r_af07326ad0017bf6fcfb9f93e43641254"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af07326ad0017bf6fcfb9f93e43641254">mbedtls_ecdh_read_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char **<a class="el" href="wsf__trace_8c.html#a631cb00ea94506727e7ab9cdd27cf9cd">buf</a>, const unsigned char *end)</td></tr>
<tr class="memdesc:af07326ad0017bf6fcfb9f93e43641254"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.  <br /></td></tr>
<tr class="separator:af07326ad0017bf6fcfb9f93e43641254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c03b82213c39abd90a5bd4b1646441d" id="r_a3c03b82213c39abd90a5bd4b1646441d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c03b82213c39abd90a5bd4b1646441d">mbedtls_ecdh_get_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *key, <a class="el" href="#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> side)</td></tr>
<tr class="memdesc:a3c03b82213c39abd90a5bd4b1646441d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up an ECDH context from an EC key.  <br /></td></tr>
<tr class="separator:a3c03b82213c39abd90a5bd4b1646441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417fd45ce78adb1b52027f995fa5ee57" id="r_a417fd45ce78adb1b52027f995fa5ee57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a417fd45ce78adb1b52027f995fa5ee57">mbedtls_ecdh_make_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *<a class="el" href="wsf__trace_8c.html#a631cb00ea94506727e7ab9cdd27cf9cd">buf</a>, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a417fd45ce78adb1b52027f995fa5ee57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates a public key and exports it as a TLS ClientKeyExchange payload.  <br /></td></tr>
<tr class="separator:a417fd45ce78adb1b52027f995fa5ee57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f417d90797b109d3036feb288e33207" id="r_a9f417d90797b109d3036feb288e33207"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f417d90797b109d3036feb288e33207">mbedtls_ecdh_read_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char *<a class="el" href="wsf__trace_8c.html#a631cb00ea94506727e7ab9cdd27cf9cd">buf</a>, size_t blen)</td></tr>
<tr class="memdesc:a9f417d90797b109d3036feb288e33207"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses and processes the ECDHE payload of a TLS ClientKeyExchange message.  <br /></td></tr>
<tr class="separator:a9f417d90797b109d3036feb288e33207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423fee27a0c8603bba336cbfe6dadcaa" id="r_a423fee27a0c8603bba336cbfe6dadcaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a423fee27a0c8603bba336cbfe6dadcaa">mbedtls_ecdh_calc_secret</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *<a class="el" href="wsf__trace_8c.html#a631cb00ea94506727e7ab9cdd27cf9cd">buf</a>, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a423fee27a0c8603bba336cbfe6dadcaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives and exports the shared secret.  <br /></td></tr>
<tr class="separator:a423fee27a0c8603bba336cbfe6dadcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains ECDH definitions and functions. </p>
<p>The Elliptic Curve Diffie-Hellman (ECDH) protocol is an anonymous key agreement protocol allowing two parties to establish a shared secret over an insecure channel. Each party must have an elliptic-curve publicâ€“private key pair.</p>
<p>For more information, see <em>NIST SP 800-56A Rev. 2: Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</em>. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="abbeab18d635fc3d2ae9afb941d41f4da" name="abbeab18d635fc3d2ae9afb941d41f4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbeab18d635fc3d2ae9afb941d41f4da">&#9670;&#160;</a></span>mbedtls_ecdh_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct mbedtls_ecdh_context mbedtls_ecdh_context</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ECDH context structure. </p>
<dl class="section warning"><dt>Warning</dt><dd>Performing multiple operations concurrently on the same ECDSA context is not supported; objects of this type should not be shared between multiple threads. </dd></dl>

</div>
</div>
<a id="ad99780d37a37e353f51c21bf5119fa1f" name="ad99780d37a37e353f51c21bf5119fa1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad99780d37a37e353f51c21bf5119fa1f">&#9670;&#160;</a></span>mbedtls_ecdh_context_mbed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct mbedtls_ecdh_context_mbed mbedtls_ecdh_context_mbed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The context used by the default ECDH implementation.</p>
<p>Later versions might change the structure of this context, therefore users should not make any assumptions about the structure of <a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a>. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ae5df12f2068df09a102e05e02fb1e39c" name="ae5df12f2068df09a102e05e02fb1e39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5df12f2068df09a102e05e02fb1e39c">&#9670;&#160;</a></span>mbedtls_ecdh_side</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the source of the imported EC key. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703" name="ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703"></a>MBEDTLS_ECDH_OURS&#160;</td><td class="fielddoc"><p>Our key. </p>
</td></tr>
<tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb" name="ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb"></a>MBEDTLS_ECDH_THEIRS&#160;</td><td class="fielddoc"><p>The key of the peer. </p>
</td></tr>
</table>

</div>
</div>
<a id="a3c17082db89e58cce0bf0731a02a20f6" name="a3c17082db89e58cce0bf0731a02a20f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c17082db89e58cce0bf0731a02a20f6">&#9670;&#160;</a></span>mbedtls_ecdh_variant</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a3c17082db89e58cce0bf0731a02a20f6">mbedtls_ecdh_variant</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the ECDH implementation used.</p>
<p>Later versions of the library may add new variants, therefore users should not make any assumptions about them. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc" name="a3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc"></a>MBEDTLS_ECDH_VARIANT_NONE&#160;</td><td class="fielddoc"><p>Implementation not defined. </p>
</td></tr>
<tr><td class="fieldname"><a id="a3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885" name="a3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885"></a>MBEDTLS_ECDH_VARIANT_MBEDTLS_2_0&#160;</td><td class="fielddoc"><p>The default Mbed TLS implementation </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a423fee27a0c8603bba336cbfe6dadcaa" name="a423fee27a0c8603bba336cbfe6dadcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a423fee27a0c8603bba336cbfe6dadcaa">&#9670;&#160;</a></span>mbedtls_ecdh_calc_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_calc_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>olen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*</td>          <td class="paramname"><span class="paramname"><em>f_rng&#160;</em></span>)(void *, unsigned char *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>p_rng</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function derives and exports the shared secret. </p>
<pre class="fragment">            This is the last function used by both TLS client
            and servers.
</pre><dl class="section note"><dt>Note</dt><dd>If <code class="param">f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and have its own private key generated and the peer's public key imported. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the total number of Bytes written on success. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The buffer to write the generated shared key to. This must be a writable buffer of size <code class="param">blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code class="param">buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function, for blinding purposes. This may b <code>NULL</code> if blinding isn't needed. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context. This may be <code>NULL</code> if <code class="param">f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a7601b043149f7171a47248b7244a4857" name="a7601b043149f7171a47248b7244a4857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7601b043149f7171a47248b7244a4857">&#9670;&#160;</a></span>mbedtls_ecdh_can_do()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_can_do </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a></td>          <td class="paramname"><span class="paramname"><em>gid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether a given group can be used for ECDH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gid</td><td>The ECP group ID to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>1</code> if the group can be used, <code>0</code> otherwise </dd></dl>

</div>
</div>
<a id="aca0670e79f3002a218d6da8c8dee61e1" name="aca0670e79f3002a218d6da8c8dee61e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0670e79f3002a218d6da8c8dee61e1">&#9670;&#160;</a></span>mbedtls_ecdh_compute_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_compute_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *</td>          <td class="paramname"><span class="paramname"><em>grp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *</td>          <td class="paramname"><span class="paramname"><em>Q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*</td>          <td class="paramname"><span class="paramname"><em>f_rng&#160;</em></span>)(void *, unsigned char *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>p_rng</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the shared secret. </p>
<pre class="fragment">            This function performs the second of two core computations
            implemented during the ECDH key exchange. The first core
            computation is performed by mbedtls_ecdh_gen_public().
</pre><dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If <code class="param">f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#acfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">z</td><td>The destination MPI (shared secret). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The public key from another party. This must be initialized. </td></tr>
    <tr><td class="paramname">d</td><td>Our secret exponent (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function. This may be <code>NULL</code> if randomization of intermediate results during the ECP computations is not needed (discouraged). See the documentation of <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a> for more. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code class="param">f_rng</code>. This may be <code>NULL</code> if <code class="param">f_rng</code> is <code>NULL</code> or doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a89cc40dc92fbbaf0275ea9a6184a5e71" name="a89cc40dc92fbbaf0275ea9a6184a5e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cc40dc92fbbaf0275ea9a6184a5e71">&#9670;&#160;</a></span>mbedtls_ecdh_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function frees a context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The context to free. This may be <code>NULL</code>, in which case this function does nothing. If it is not <code>NULL</code>, it must point to an initialized ECDH context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a403a5d7363b6219a2017b837b665c354" name="a403a5d7363b6219a2017b837b665c354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a403a5d7363b6219a2017b837b665c354">&#9670;&#160;</a></span>mbedtls_ecdh_gen_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_gen_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *</td>          <td class="paramname"><span class="paramname"><em>grp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *</td>          <td class="paramname"><span class="paramname"><em>Q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*</td>          <td class="paramname"><span class="paramname"><em>f_rng&#160;</em></span>)(void *, unsigned char *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>p_rng</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates an ECDH keypair on an elliptic curve. </p>
<p>This function performs the first of two core computations implemented during the ECDH key exchange. The second core computation is performed by <a class="el" href="#aca0670e79f3002a218d6da8c8dee61e1" title="This function computes the shared secret.">mbedtls_ecdh_compute_shared()</a>.</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#acfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">d</td><td>The destination MPI (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The destination point (public key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code class="param">f_rng</code>. This may be <code>NULL</code> in case <code class="param">f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a3c03b82213c39abd90a5bd4b1646441d" name="a3c03b82213c39abd90a5bd4b1646441d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c03b82213c39abd90a5bd4b1646441d">&#9670;&#160;</a></span>mbedtls_ecdh_get_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_get_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a></td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets up an ECDH context from an EC key. </p>
<pre class="fragment">            It is used by clients and servers in place of the
            ServerKeyEchange for static ECDH, and imports ECDH
            parameters from the EC key information of a certificate.
</pre><dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">key</td><td>The EC key to use. This must be initialized. </td></tr>
    <tr><td class="paramname">side</td><td>Defines the source of the key. Possible values are:<ul>
<li><a class="el" href="#ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>: The key is ours.</li>
<li><a class="el" href="#ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>: The key is that of the peer.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a97e787a12f7aae180ab9828303199dca" name="a97e787a12f7aae180ab9828303199dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e787a12f7aae180ab9828303199dca">&#9670;&#160;</a></span>mbedtls_ecdh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an ECDH context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to initialize. This must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a784e56d5eea12e38374e9ce028692940" name="a784e56d5eea12e38374e9ce028692940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784e56d5eea12e38374e9ce028692940">&#9670;&#160;</a></span>mbedtls_ecdh_make_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>olen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*</td>          <td class="paramname"><span class="paramname"><em>f_rng&#160;</em></span>)(void *, unsigned char *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>p_rng</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange handshake message. </p>
<p>This is the second function used by a TLS server for ECDHE ciphersuites. (It is called after <a class="el" href="#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code class="param">blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code class="param">buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code class="param">f_rng</code>. This may be <code>NULL</code> in case <code class="param">f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a417fd45ce78adb1b52027f995fa5ee57" name="a417fd45ce78adb1b52027f995fa5ee57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a417fd45ce78adb1b52027f995fa5ee57">&#9670;&#160;</a></span>mbedtls_ecdh_make_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>olen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*</td>          <td class="paramname"><span class="paramname"><em>f_rng&#160;</em></span>)(void *, unsigned char *, size_t), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>p_rng</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates a public key and exports it as a TLS ClientKeyExchange payload. </p>
<p>This is the second function used by a TLS client for ECDH(E) ciphersuites.</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, the latter usually by <a class="el" href="#af07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code class="param">blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The size of the destination buffer <code class="param">buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code class="param">f_rng</code>. This may be <code>NULL</code> in case <code class="param">f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a6d549348fe93c843c19bfcd102b6e94f">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="af07326ad0017bf6fcfb9f93e43641254" name="af07326ad0017bf6fcfb9f93e43641254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07326ad0017bf6fcfb9f93e43641254">&#9670;&#160;</a></span>mbedtls_ecdh_read_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message. </p>
<dl class="section note"><dt>Note</dt><dd>In a TLS handshake, this is the how the client sets up its ECDHE context from the server's public ECDHE key material.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDHE context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">buf</td><td>On input, <code>*buf</code> must be the start of the input buffer. On output, <code>*buf</code> is updated to point to the end of the data that has been read. On success, this is the first byte past the end of the ServerKeyExchange parameters. On error, this is the point at which an error has been detected, which is usually not useful except to debug failures. </td></tr>
    <tr><td class="paramname">end</td><td>The end of the input buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a9f417d90797b109d3036feb288e33207" name="a9f417d90797b109d3036feb288e33207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f417d90797b109d3036feb288e33207">&#9670;&#160;</a></span>mbedtls_ecdh_read_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>blen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function parses and processes the ECDHE payload of a TLS ClientKeyExchange message. </p>
<p>This is the third function used by a TLS server for ECDH(E) ciphersuites. (It is called after <a class="el" href="#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a> and <a class="el" href="#a784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="#a296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">buf</td><td>The pointer to the ClientKeyExchange payload. This must be a readable buffer of length <code class="param">blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the input buffer <code class="param">buf</code> in Bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="a296f6ce7b1b8b53d048a6c28ff3420cc" name="a296f6ce7b1b8b53d048a6c28ff3420cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296f6ce7b1b8b53d048a6c28ff3420cc">&#9670;&#160;</a></span>mbedtls_ecdh_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#af79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a></td>          <td class="paramname"><span class="paramname"><em>grp_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets up the ECDH context with the information given. </p>
<p>This function should be called after <a class="el" href="#a97e787a12f7aae180ab9828303199dca" title="This function initializes an ECDH context.">mbedtls_ecdh_init()</a> but before <a class="el" href="#a784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>. There is no need to call this function before <a class="el" href="#af07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>.</p>
<p>This is the first function used by a TLS server for ECDHE ciphersuites.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">grp_id</td><td>The group id of the group to set up the context for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_456207283565120b441ff9733579e7b8.html">connectivity</a></li><li class="navelem"><a class="el" href="dir_06808dc80d25155593de47e35f5ad833.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_1a97d379f1d049ad6ab5b482ff1ca2ae.html">include</a></li><li class="navelem"><a class="el" href="dir_30f5d8d4a52b0101eff432da4ba2c27a.html">mbedtls</a></li><li class="navelem"><a class="el" href="ecdh_8h.html">ecdh.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
