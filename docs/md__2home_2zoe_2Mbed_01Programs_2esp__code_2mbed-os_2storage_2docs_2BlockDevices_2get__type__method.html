<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP API: Get type method addon to block devices class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2home_2zoe_2Mbed_01Programs_2esp__code_2mbed-os_2storage_2docs_2BlockDevices_2get__type__method.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Get type method addon to block devices class</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md907"></a></p>
<h2><a class="anchor" id="autotoc_md908"></a>
Revision history</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Revision   </th><th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Authors   </th><th class="markdownTableHeadNone">Mbed OS version   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1.0   </td><td class="markdownTableBodyNone">04/12/2018   </td><td class="markdownTableBodyNone">Yossi Levy (<a href="https://github.com/yossi2le/">@yossi2le</a>)   </td><td class="markdownTableBodyNone">5.11+   </td><td class="markdownTableBodyNone">Initial revision   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md909"></a>
Introduction</h1>
<p>Most storage solutions use block devices, whether it is Filesystems, KVStore or any other solution most of them will have some <a class="el" href="classBlockDevice.html">BlockDevice</a> class underneath. However, sometimes a storage type or an application needs to know the physical <a class="el" href="classBlockDevice.html">BlockDevice</a> type in order to work smoothly or the <a class="el" href="classBlockDevice.html">BlockDevice</a> type in order to decide what is the best storage configuration to use. To address this an add-on method of getting type is proposed for <a class="el" href="classBlockDevice.html">BlockDevice</a> interface class.</p>
<h1><a class="anchor" id="autotoc_md910"></a>
The Motivation</h1>
<p>An example to explain the motivation and the need for the adding of get_type to <a class="el" href="classBlockDevice.html">BlockDevice</a> interface: when creating a file system you would prefer working with FAT on top of SD while LITTLEFS on top of any flash block device. Those preferences are in favor of better performance.</p>
<p>To summarize the above, it may be very useful when using block device to know the type of the instance and especially, but not only, when using get_default_instace. Sometimes applications and tests would like to behave differently depending on the instance that has been created or provided to them.</p>
<p>In fact it might be worth to consider adding the get_type to any interface with get_default_instance at mbed-os. <br  />
</p>
<h1><a class="anchor" id="autotoc_md911"></a>
Dive into details</h1>
<p>we should add the following method to <a class="el" href="classBlockDevice.html">BlockDevice</a> interface class.</p>
<div class="fragment"><div class="line">const char * get_type() const = 0;</div>
</div><!-- fragment --><p>then every physical <a class="el" href="classBlockDevice.html">BlockDevice</a> class which implements the interface should also implement this method and return a string representing its type. Furthermore, a nonphysical <a class="el" href="classBlockDevice.html">BlockDevice</a> like <a class="el" href="classSlicingBlockDevice.html">SlicingBlockDevice</a> should return the underlying physical <a class="el" href="classBlockDevice.html">BlockDevice</a> type.</p>
<h2><a class="anchor" id="autotoc_md912"></a>
Physical BlockDevice:</h2>
<div class="fragment"><div class="line">const char * HeapBlockDevice::get_type() const</div>
<div class="line">{</div>
<div class="line">    return &quot;HEAP&quot;;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md913"></a>
Logical BlockDevice:</h2>
<div class="fragment"><div class="line">const char * SlicingBlockDevice::get_type() const</div>
<div class="line">{</div>
<div class="line">    if (_bd != NULL) {</div>
<div class="line">     return _bd-&gt;get_type();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    return NULL;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md914"></a>
Open issue</h2>
<p>The <a class="el" href="classChainingBlockDevice.html">ChainingBlockDevice</a> which chains different type of physical block devices into one block device is unable to return the underneath physical as it contains two or more types. Therefore it will return CHAINING as its identity and its left for the user to decide how the application will treat this information.</p>
<p>The below table describes physical <a class="el" href="classBlockDevice.html">BlockDevice</a> and its tyep names</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classBlockDevice.html">BlockDevice</a> class   </th><th class="markdownTableHeadNone">String description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classHeapBlockDevice.html">HeapBlockDevice</a>   </td><td class="markdownTableBodyNone">"HEAP"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classSPIFBlockDevice.html">SPIFBlockDevice</a>   </td><td class="markdownTableBodyNone">"SPIF"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classQSPIFBlockDevice.html">QSPIFBlockDevice</a>   </td><td class="markdownTableBodyNone">"QSPIF"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SDBlockDevice   </td><td class="markdownTableBodyNone">"SD"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">FlashIAPBlockDevice   </td><td class="markdownTableBodyNone">"FLASHIAP"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classDataFlashBlockDevice.html">DataFlashBlockDevice</a>   </td><td class="markdownTableBodyNone">"DATAFLASH"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classChainingBlockDevice.html">ChainingBlockDevice</a>   </td><td class="markdownTableBodyNone">"CHAINING"   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
