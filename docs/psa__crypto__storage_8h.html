<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP API: /home/zoe/Mbed Programs/esp_code/mbed-os/platform/FEATURE_EXPERIMENTAL_API/FEATURE_PSA/TARGET_MBED_PSA_SRV/mbedtls/psa_crypto_storage.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('psa__crypto__storage_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">psa_crypto_storage.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>PSA cryptography module: Mbed TLS key storage.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;psa/crypto.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__se__driver_8h_source.html">psa/crypto_se_driver.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div>
<p><a href="psa__crypto__storage_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa995fb30d6555ebaacfcada9e27115d4" id="r_aa995fb30d6555ebaacfcada9e27115d4"><td class="memItemLeft" align="right" valign="top"><a id="aa995fb30d6555ebaacfcada9e27115d4" name="aa995fb30d6555ebaacfcada9e27115d4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PSA_CRYPTO_MAX_STORAGE_SIZE</b>&#160;&#160;&#160;( PSA_BITS_TO_BYTES( PSA_MAX_KEY_BITS ) )</td></tr>
<tr class="separator:aa995fb30d6555ebaacfcada9e27115d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f53edc9436231bd8138ceebb56b1eaf" id="r_a1f53edc9436231bd8138ceebb56b1eaf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f53edc9436231bd8138ceebb56b1eaf">PSA_MAX_PERSISTENT_KEY_IDENTIFIER</a>&#160;&#160;&#160;<a class="el" href="group__key__lifetimes.html#ga3afb6bb4644c995cf95309a71e7baeb1">PSA_KEY_ID_VENDOR_MAX</a></td></tr>
<tr class="separator:a1f53edc9436231bd8138ceebb56b1eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a95d26803213b8425cf14a9f16916bb65" id="r_a95d26803213b8425cf14a9f16916bb65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95d26803213b8425cf14a9f16916bb65">psa_is_key_present_in_storage</a> (const mbedtls_svc_key_id_t key)</td></tr>
<tr class="memdesc:a95d26803213b8425cf14a9f16916bb65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if persistent data is stored for the given key slot number.  <br /></td></tr>
<tr class="separator:a95d26803213b8425cf14a9f16916bb65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78645f1dcc3458315b142c77aff09382" id="r_a78645f1dcc3458315b142c77aff09382"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78645f1dcc3458315b142c77aff09382">psa_save_persistent_key</a> (const <a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *attr, const uint8_t *data, const size_t data_length)</td></tr>
<tr class="memdesc:a78645f1dcc3458315b142c77aff09382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format key data and metadata and save to a location for given key slot.  <br /></td></tr>
<tr class="separator:a78645f1dcc3458315b142c77aff09382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded344ea042c85f129f222ad059162ed" id="r_aded344ea042c85f129f222ad059162ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aded344ea042c85f129f222ad059162ed">psa_load_persistent_key</a> (<a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *attr, uint8_t **data, size_t *data_length)</td></tr>
<tr class="memdesc:aded344ea042c85f129f222ad059162ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses key data and metadata and load persistent key for given key slot number.  <br /></td></tr>
<tr class="separator:aded344ea042c85f129f222ad059162ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b623ae5d6558ada6b09b8e3c7f5ea9" id="r_a00b623ae5d6558ada6b09b8e3c7f5ea9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00b623ae5d6558ada6b09b8e3c7f5ea9">psa_destroy_persistent_key</a> (const mbedtls_svc_key_id_t key)</td></tr>
<tr class="memdesc:a00b623ae5d6558ada6b09b8e3c7f5ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove persistent data for the given key slot number.  <br /></td></tr>
<tr class="separator:a00b623ae5d6558ada6b09b8e3c7f5ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0dd64dae227f5ce4b230155afd3004b" id="r_ae0dd64dae227f5ce4b230155afd3004b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0dd64dae227f5ce4b230155afd3004b">psa_free_persistent_key_data</a> (uint8_t *key_data, size_t key_data_length)</td></tr>
<tr class="memdesc:ae0dd64dae227f5ce4b230155afd3004b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the temporary buffer allocated by <a class="el" href="#aded344ea042c85f129f222ad059162ed" title="Parses key data and metadata and load persistent key for given key slot number.">psa_load_persistent_key()</a>.  <br /></td></tr>
<tr class="separator:ae0dd64dae227f5ce4b230155afd3004b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba107119c00a49e6c5aa60dcec1f7932" id="r_aba107119c00a49e6c5aa60dcec1f7932"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba107119c00a49e6c5aa60dcec1f7932">psa_format_key_data_for_storage</a> (const uint8_t *data, const size_t data_length, const <a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *attr, uint8_t *storage_data)</td></tr>
<tr class="memdesc:aba107119c00a49e6c5aa60dcec1f7932"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats key data and metadata for persistent storage.  <br /></td></tr>
<tr class="separator:aba107119c00a49e6c5aa60dcec1f7932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1ef1f6ba0c4df911641a44623ba8fc" id="r_ade1ef1f6ba0c4df911641a44623ba8fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade1ef1f6ba0c4df911641a44623ba8fc">psa_parse_key_data_from_storage</a> (const uint8_t *storage_data, size_t storage_data_length, uint8_t **key_data, size_t *key_data_length, <a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *attr)</td></tr>
<tr class="memdesc:ade1ef1f6ba0c4df911641a44623ba8fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses persistent storage data into key data and metadata.  <br /></td></tr>
<tr class="separator:ade1ef1f6ba0c4df911641a44623ba8fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PSA cryptography module: Mbed TLS key storage. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1f53edc9436231bd8138ceebb56b1eaf" name="a1f53edc9436231bd8138ceebb56b1eaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f53edc9436231bd8138ceebb56b1eaf">&#9670;&#160;</a></span>PSA_MAX_PERSISTENT_KEY_IDENTIFIER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSA_MAX_PERSISTENT_KEY_IDENTIFIER&#160;&#160;&#160;<a class="el" href="group__key__lifetimes.html#ga3afb6bb4644c995cf95309a71e7baeb1">PSA_KEY_ID_VENDOR_MAX</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The maximum permitted persistent slot number.</p>
<p>In Mbed Crypto 0.1.0b:</p><ul>
<li>Using the file backend, all key ids are ok except 0.</li>
<li>Using the ITS backend, all key ids are ok except 0xFFFFFF52 (PSA_CRYPTO_ITS_RANDOM_SEED_UID) for which the file contains the device's random seed (if this feature is enabled).</li>
<li>Only key ids from 1 to PSA_KEY_SLOT_COUNT are actually used.</li>
</ul>
<p>Since we need to preserve the random seed, avoid using that key slot. Reserve a whole range of key slots just in case something else comes up.</p>
<p>This limitation will probably become moot when we implement client separation for key storage. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a00b623ae5d6558ada6b09b8e3c7f5ea9" name="a00b623ae5d6558ada6b09b8e3c7f5ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b623ae5d6558ada6b09b8e3c7f5ea9">&#9670;&#160;</a></span>psa_destroy_persistent_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_destroy_persistent_key </td>
          <td>(</td>
          <td class="paramtype">const mbedtls_svc_key_id_t</td>          <td class="paramname"><span class="paramname"><em>key</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove persistent data for the given key slot number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Persistent identifier of the key to remove from persistent storage.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td>The key was successfully removed, or the key did not exist. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aba107119c00a49e6c5aa60dcec1f7932" name="aba107119c00a49e6c5aa60dcec1f7932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba107119c00a49e6c5aa60dcec1f7932">&#9670;&#160;</a></span>psa_format_key_data_for_storage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void psa_format_key_data_for_storage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t</td>          <td class="paramname"><span class="paramname"><em>data_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>storage_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formats key data and metadata for persistent storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td><a class="el" href="classBuffer.html">Buffer</a> containing the key data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_length</td><td>Length of the key data buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attr</td><td>The core attributes of the key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">storage_data</td><td>Output buffer for the formatted data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae0dd64dae227f5ce4b230155afd3004b" name="ae0dd64dae227f5ce4b230155afd3004b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0dd64dae227f5ce4b230155afd3004b">&#9670;&#160;</a></span>psa_free_persistent_key_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void psa_free_persistent_key_data </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>key_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_data_length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free the temporary buffer allocated by <a class="el" href="#aded344ea042c85f129f222ad059162ed" title="Parses key data and metadata and load persistent key for given key slot number.">psa_load_persistent_key()</a>. </p>
<p>This function must be called at some point after <a class="el" href="#aded344ea042c85f129f222ad059162ed" title="Parses key data and metadata and load persistent key for given key slot number.">psa_load_persistent_key()</a> to zeroize and free the memory allocated to the buffer in that function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key_data</td><td><a class="el" href="classBuffer.html">Buffer</a> for the key data. </td></tr>
    <tr><td class="paramname">key_data_length</td><td>Size of the key data buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a95d26803213b8425cf14a9f16916bb65" name="a95d26803213b8425cf14a9f16916bb65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d26803213b8425cf14a9f16916bb65">&#9670;&#160;</a></span>psa_is_key_present_in_storage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int psa_is_key_present_in_storage </td>
          <td>(</td>
          <td class="paramtype">const mbedtls_svc_key_id_t</td>          <td class="paramname"><span class="paramname"><em>key</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if persistent data is stored for the given key slot number. </p>
<p>This function checks if any key data or metadata exists for the key slot in the persistent storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Persistent identifier to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>No persistent data present for slot number </td></tr>
    <tr><td class="paramname">1</td><td>Persistent data present for slot number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aded344ea042c85f129f222ad059162ed" name="aded344ea042c85f129f222ad059162ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded344ea042c85f129f222ad059162ed">&#9670;&#160;</a></span>psa_load_persistent_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_load_persistent_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>data_length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses key data and metadata and load persistent key for given key slot number. </p>
<p>This function reads from a storage backend, parses the key data and metadata and writes them to the appropriate output parameters.</p>
<p>Note: This function allocates a buffer and returns a pointer to it through the data parameter. <a class="el" href="#ae0dd64dae227f5ce4b230155afd3004b" title="Free the temporary buffer allocated by psa_load_persistent_key().">psa_free_persistent_key_data()</a> must be called after this function to zeroize and free this buffer, regardless of whether this function succeeds or fails.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">attr</td><td>On input, the key identifier field identifies the key to load. Other fields are ignored. On success, the attribute structure contains the key metadata that was loaded from storage. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Pointer to an allocated key data buffer on return. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data_length</td><td>The number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga18646babb2ae6cbde02ea3828bbd9141">PSA_ERROR_DOES_NOT_EXIST</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ade1ef1f6ba0c4df911641a44623ba8fc" name="ade1ef1f6ba0c4df911641a44623ba8fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1ef1f6ba0c4df911641a44623ba8fc">&#9670;&#160;</a></span>psa_parse_key_data_from_storage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_parse_key_data_from_storage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>storage_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>storage_data_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **</td>          <td class="paramname"><span class="paramname"><em>key_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>key_data_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses persistent storage data into key data and metadata. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">storage_data</td><td><a class="el" href="classBuffer.html">Buffer</a> for the storage data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">storage_data_length</td><td>Length of the storage data buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key_data</td><td>On output, pointer to a newly allocated buffer containing the key data. This must be freed using <a class="el" href="#ae0dd64dae227f5ce4b230155afd3004b" title="Free the temporary buffer allocated by psa_load_persistent_key().">psa_free_persistent_key_data()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key_data_length</td><td>Length of the key data buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attr</td><td>On success, the attribute structure is filled with the loaded key metadata.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766">PSA_ERROR_INSUFFICIENT_STORAGE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a78645f1dcc3458315b142c77aff09382" name="a78645f1dcc3458315b142c77aff09382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78645f1dcc3458315b142c77aff09382">&#9670;&#160;</a></span>psa_save_persistent_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_save_persistent_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structpsa__core__key__attributes__t.html">psa_core_key_attributes_t</a> *</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t</td>          <td class="paramname"><span class="paramname"><em>data_length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format key data and metadata and save to a location for given key slot. </p>
<p>This function formats the key data and metadata and saves it to a persistent storage backend. The storage location corresponding to the key slot must be empty, otherwise this function will fail. This function should be called after loading the key into an internal slot to ensure the persistent key is not saved into a storage location corresponding to an already occupied non-persistent key, as well as ensuring the key data is validated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">attr</td><td>The attributes of the key to save. The key identifier field in the attributes determines the key's location. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td><a class="el" href="classBuffer.html">Buffer</a> containing the key data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_length</td><td>The number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766">PSA_ERROR_INSUFFICIENT_STORAGE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gaf2b34cc87edc72f3ba90071a08210d20">PSA_ERROR_ALREADY_EXISTS</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_d00fafdb9414f6e624fcf4d73ffde065.html">platform</a></li><li class="navelem"><a class="el" href="dir_a72924067aea8bbead751f11070268f4.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_007a19531d3d09289f9f9c2cf309e91b.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_05e0d8a557d855fa23572451f1c8ea18.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_633e5a0a3aeab3d610eaffa2e7e4e08f.html">mbedtls</a></li><li class="navelem"><a class="el" href="psa__crypto__storage_8h.html">psa_crypto_storage.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
