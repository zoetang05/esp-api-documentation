<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP API: useful_out_buf Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structuseful__out__buf.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structuseful__out__buf-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">useful_out_buf Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="UsefulBuf_8h_source.html">UsefulBuf.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7b6d87be1ff1a17bfca12c162e75d150" id="r_a7b6d87be1ff1a17bfca12c162e75d150"><td class="memItemLeft" align="right" valign="top"><a id="a7b6d87be1ff1a17bfca12c162e75d150" name="a7b6d87be1ff1a17bfca12c162e75d150"></a>
<a class="el" href="UsefulBuf_8h.html#aa7643740fe44091c5c6507368863e85c">UsefulBuf</a>&#160;</td><td class="memItemRight" valign="bottom"><b>UB</b></td></tr>
<tr class="separator:a7b6d87be1ff1a17bfca12c162e75d150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494ae4257fcd44756c3d51e40900ff6b" id="r_a494ae4257fcd44756c3d51e40900ff6b"><td class="memItemLeft" align="right" valign="top"><a id="a494ae4257fcd44756c3d51e40900ff6b" name="a494ae4257fcd44756c3d51e40900ff6b"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>data_len</b></td></tr>
<tr class="separator:a494ae4257fcd44756c3d51e40900ff6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa827dbbc81f8b7f50e73135dcf5a4c96" id="r_aa827dbbc81f8b7f50e73135dcf5a4c96"><td class="memItemLeft" align="right" valign="top"><a id="aa827dbbc81f8b7f50e73135dcf5a4c96" name="aa827dbbc81f8b7f50e73135dcf5a4c96"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>magic</b></td></tr>
<tr class="separator:aa827dbbc81f8b7f50e73135dcf5a4c96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b9c2f9bfb186356e986100cd038bf6" id="r_ac0b9c2f9bfb186356e986100cd038bf6"><td class="memItemLeft" align="right" valign="top"><a id="ac0b9c2f9bfb186356e986100cd038bf6" name="ac0b9c2f9bfb186356e986100cd038bf6"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>err</b></td></tr>
<tr class="separator:ac0b9c2f9bfb186356e986100cd038bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> is a structure and functions (an object) that are good for serializing data into a buffer such as is often done with network protocols or data written to files.</p>
<p>The main idea is that all the pointer manipulation for adding data is done by <a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> functions so the caller doesn't have to do any. All the pointer manipulation is centralized here. This code will have been reviewed and written carefully so it spares the caller of much of this work and results in much safer code with much less work.</p>
<p>The functions to add data to the output buffer always check the length and will never write off the end of the output buffer. If an attempt to add data that will not fit is made, an internal error flag will be set and further attempts to add data will not do anything.</p>
<p>Basically, if you initialized with the correct buffer, there is no way to ever write off the end of that buffer when calling the Add and Insert functions here.</p>
<p>The functions to add data do not return an error. The working model is that the caller just makes all the calls to add data without any error checking on each one. The error is instead checked after all the data is added when the result is to be used. This makes the caller's code cleaner.</p>
<p>There is a utility function to get the error status anytime along the way if the caller wants. There are functions to see how much room is left and see if some data will fit too, but their use is generally not necessary.</p>
<p>The general call flow is like this:</p>
<ul>
<li>Initialize the <a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> with the buffer that is to have the data added. The caller allocates the buffer. It can be heap or stack or shared memory (or other).</li>
<li>Make calls to add data to the output buffer. Insert and append are both supported. The append and insert calls will never write off the end of the buffer.</li>
<li>When all data is added, check the error status to make sure everything fit.</li>
<li>Get the resulting serialized data either as a <a class="el" href="UsefulBuf_8h.html#aa7643740fe44091c5c6507368863e85c">UsefulBuf</a> (a pointer and length) or have it copied to another buffer.</li>
</ul>
<p><a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> can be initialized with just a buffer length by passing NULL as the pointer to the output buffer. This is useful if you want to go through the whole serialization process to either see if it will fit into a given buffer or compute the size of the buffer needed. Pass a very large buffer size when calling Init, if you want just to compute the size.</p>
<p>Some inexpensive simple sanity checks are performed before every data addition to guard against use of an uninitialized or corrupted <a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a>.</p>
<p>This has been used to create a CBOR encoder. The CBOR encoder has almost no pointer manipulation in it, is much easier to read, and easier to review.</p>
<p>A <a class="el" href="UsefulBuf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> is 27 bytes or 15 bytes on 64- or 32-bit machines so it can go on the stack or be a C99 function parameter. </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/zoe/Mbed Programs/esp_code/mbed-os/platform/FEATURE_EXPERIMENTAL_API/FEATURE_PSA/TARGET_MBED_PSA_SRV/services/attestation/qcbor/inc/<a class="el" href="UsefulBuf_8h_source.html">UsefulBuf.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structuseful__out__buf.html">useful_out_buf</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
