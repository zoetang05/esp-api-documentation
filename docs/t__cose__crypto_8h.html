<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP API: /home/zoe/Mbed Programs/esp_code/mbed-os/platform/FEATURE_EXPERIMENTAL_API/FEATURE_PSA/TARGET_MBED_PSA_SRV/services/attestation/tfm_impl/t_cose/src/t_cose_crypto.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('t__cose__crypto_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">t_cose_crypto.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This is the adaptation layer for cryptographic functions used by t_cose.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="t__cose__common_8h_source.html">t_cose_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="useful__buf_8h_source.html">useful_buf.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="t__cose__defines_8h_source.html">t_cose_defines.h</a>&quot;</code><br />
</div>
<p><a href="t__cose__crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af3b10e1de18907f2367c15d4acc6c5b5" id="r_af3b10e1de18907f2367c15d4acc6c5b5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3b10e1de18907f2367c15d4acc6c5b5">T_COSE_EC_P256_SIG_SIZE</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:af3b10e1de18907f2367c15d4acc6c5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4782c1eaebe0998c2362cd061aaa969d" id="r_a4782c1eaebe0998c2362cd061aaa969d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4782c1eaebe0998c2362cd061aaa969d">T_COSE_MAX_EC_SIG_SIZE</a>&#160;&#160;&#160;<a class="el" href="#af3b10e1de18907f2367c15d4acc6c5b5">T_COSE_EC_P256_SIG_SIZE</a></td></tr>
<tr class="separator:a4782c1eaebe0998c2362cd061aaa969d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6150872ec64deffbf6841b523209a93" id="r_ae6150872ec64deffbf6841b523209a93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6150872ec64deffbf6841b523209a93">T_COSE_CRYPTO_EC_P256_COORD_SIZE</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:ae6150872ec64deffbf6841b523209a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac3a4bfc83ba354a09add9b71e8a68f" id="r_a0ac3a4bfc83ba354a09add9b71e8a68f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ac3a4bfc83ba354a09add9b71e8a68f">T_COSE_CRYPTO_SHA256_SIZE</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a0ac3a4bfc83ba354a09add9b71e8a68f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ab8519436340643fed475dbf7f38c91" id="r_a4ab8519436340643fed475dbf7f38c91"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ab8519436340643fed475dbf7f38c91">t_cose_crypto_pub_key_sign</a> (int32_t cose_alg_id, int32_t key_select, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> hash_to_sign, struct <a class="el" href="structuseful__buf.html">useful_buf</a> signature_buffer, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *signature)</td></tr>
<tr class="memdesc:a4ab8519436340643fed475dbf7f38c91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform public key signing. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:a4ab8519436340643fed475dbf7f38c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e0826243f262003d07b74e689aeefc8" id="r_a6e0826243f262003d07b74e689aeefc8"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e0826243f262003d07b74e689aeefc8">t_cose_crypto_pub_key_verify</a> (int32_t cose_alg_id, int32_t key_select, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> key_id, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> hash_to_verify, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> signature)</td></tr>
<tr class="memdesc:a6e0826243f262003d07b74e689aeefc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform public key signature verification. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:a6e0826243f262003d07b74e689aeefc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff1c02d3bc0a2f98f97a95500afa7fc" id="r_aaff1c02d3bc0a2f98f97a95500afa7fc"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaff1c02d3bc0a2f98f97a95500afa7fc">t_cose_crypto_get_ec_pub_key</a> (int32_t key_select, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> kid, int32_t *cose_curve_id, struct <a class="el" href="structuseful__buf.html">useful_buf</a> buf_to_hold_x_coord, struct <a class="el" href="structuseful__buf.html">useful_buf</a> buf_to_hold_y_coord, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *x_coord, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *y_coord)</td></tr>
<tr class="memdesc:aaff1c02d3bc0a2f98f97a95500afa7fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an elliptic curve public key. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:aaff1c02d3bc0a2f98f97a95500afa7fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f88ad8d0afcd13b47eee3834d65329" id="r_ae5f88ad8d0afcd13b47eee3834d65329"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5f88ad8d0afcd13b47eee3834d65329">t_cose_crypto_hash_start</a> (struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *hash_ctx, int32_t cose_hash_alg_id)</td></tr>
<tr class="memdesc:ae5f88ad8d0afcd13b47eee3834d65329"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start cryptographic hash. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:ae5f88ad8d0afcd13b47eee3834d65329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7630a1ca6c5eb1722ff5356b91acdf92" id="r_a7630a1ca6c5eb1722ff5356b91acdf92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7630a1ca6c5eb1722ff5356b91acdf92">t_cose_crypto_hash_update</a> (struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *hash_ctx, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> data_to_hash)</td></tr>
<tr class="memdesc:a7630a1ca6c5eb1722ff5356b91acdf92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Feed data into a cryptographic hash. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:a7630a1ca6c5eb1722ff5356b91acdf92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61c4d5459a7ec7c9a9b1b9beaed91db" id="r_ad61c4d5459a7ec7c9a9b1b9beaed91db"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad61c4d5459a7ec7c9a9b1b9beaed91db">t_cose_crypto_hash_finish</a> (struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *hash_ctx, struct <a class="el" href="structuseful__buf.html">useful_buf</a> buffer_to_hold_result, struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *hash_result)</td></tr>
<tr class="memdesc:ad61c4d5459a7ec7c9a9b1b9beaed91db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish a cryptographic hash. Part of the t_cose crypto adaptation layer.  <br /></td></tr>
<tr class="separator:ad61c4d5459a7ec7c9a9b1b9beaed91db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the adaptation layer for cryptographic functions used by t_cose. </p>
<p>This is small wrapper around the cryptographic functions to:</p><ul>
<li>Map COSE algorithm IDs to TF-M algorithm IDs</li>
<li>Map crypto errors to <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> errors</li>
<li>Have inputs and outputs be <code>struct</code> <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> and <code>struct</code> <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> </li>
<li>Handle key selection</li>
</ul>
<p>The idea is that implementations can be made of these functions that adapt to various cryptographic libraries that are used on various platforms and OSs.</p>
<p>This runs entirely off of COSE-style algorithm identifiers. They are simple integers and thus work nice as function parameters. An initial set is defined by [COSE (RFC 8152)] (<a href="https://tools.ietf.org/html/rfc8152">https://tools.ietf.org/html/rfc8152</a>). New ones can be registered in the [IANA COSE Registry] (<a href="https://www.iana.org/assignments/cose/cose.xhtml">https://www.iana.org/assignments/cose/cose.xhtml</a>). Local use new ones can also be defined (<code>#define</code>) if what is needed is not in the IANA registry.</p>
<p>Binary data is returned to the caller using a <code>struct</code> <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> to pass the buffer to receive the data and its length in and a <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> to return the pointer and length of the returned data. The point of this is coding hygiene. The buffer passed in is not const as it is to be modified. The <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> returned is const.</p>
<p>The pointer in the <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> will always point to the buffer passed in via the <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> so the lifetime of the data is under control of the caller.</p>
<p>This is not intended as any sort of general cryptographic API. It is just the functions needed by t_cose in the form that is most useful for t_cose. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae6150872ec64deffbf6841b523209a93" name="ae6150872ec64deffbf6841b523209a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6150872ec64deffbf6841b523209a93">&#9670;&#160;</a></span>T_COSE_CRYPTO_EC_P256_COORD_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T_COSE_CRYPTO_EC_P256_COORD_SIZE&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of X and Y coordinate in 2 parameter style EC public key. Format is as defined in [COSE (RFC 8152)] (<a href="https://tools.ietf.org/html/rfc8152">https://tools.ietf.org/html/rfc8152</a>) and <a href="http://www.secg.org/sec1-v2.pdf">SEC 1: Elliptic Curve Cryptography</a>.</p>
<p>This size is well-known and documented in public standards. </p>

</div>
</div>
<a id="a0ac3a4bfc83ba354a09add9b71e8a68f" name="a0ac3a4bfc83ba354a09add9b71e8a68f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac3a4bfc83ba354a09add9b71e8a68f">&#9670;&#160;</a></span>T_COSE_CRYPTO_SHA256_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T_COSE_CRYPTO_SHA256_SIZE&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of the output of SHA-256 in bytes.</p>
<p>(It is safe to define this independently here as its size is well-known and fixed. There is no need to reference platform-specific headers and incur messy dependence.) </p>

</div>
</div>
<a id="af3b10e1de18907f2367c15d4acc6c5b5" name="af3b10e1de18907f2367c15d4acc6c5b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b10e1de18907f2367c15d4acc6c5b5">&#9670;&#160;</a></span>T_COSE_EC_P256_SIG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T_COSE_EC_P256_SIG_SIZE&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of the signature output for the NIST P-256 Curve. </p>

</div>
</div>
<a id="a4782c1eaebe0998c2362cd061aaa969d" name="a4782c1eaebe0998c2362cd061aaa969d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4782c1eaebe0998c2362cd061aaa969d">&#9670;&#160;</a></span>T_COSE_MAX_EC_SIG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T_COSE_MAX_EC_SIG_SIZE&#160;&#160;&#160;<a class="el" href="#af3b10e1de18907f2367c15d4acc6c5b5">T_COSE_EC_P256_SIG_SIZE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of the largest signature of any of the algorithm types supported.</p>
<p>This will have to be adjusted if support for other algorithms larger is added.</p>
<p>This is a compile time constant so it can be used to define stack variable sizes. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aaff1c02d3bc0a2f98f97a95500afa7fc" name="aaff1c02d3bc0a2f98f97a95500afa7fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff1c02d3bc0a2f98f97a95500afa7fc">&#9670;&#160;</a></span>t_cose_crypto_get_ec_pub_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> t_cose_crypto_get_ec_pub_key </td>
          <td>(</td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>key_select</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>kid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *</td>          <td class="paramname"><span class="paramname"><em>cose_curve_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf.html">useful_buf</a></td>          <td class="paramname"><span class="paramname"><em>buf_to_hold_x_coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf.html">useful_buf</a></td>          <td class="paramname"><span class="paramname"><em>buf_to_hold_y_coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *</td>          <td class="paramname"><span class="paramname"><em>x_coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *</td>          <td class="paramname"><span class="paramname"><em>y_coord</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an elliptic curve public key. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key_select</td><td>Used to look up the public key to return when <code>kid</code> is <code>NULL_USEFUL_BUF_C</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kid</td><td>A key ID to look up against. May be <code>NULL_USEFUL_BUF_C</code>. This is typically the kid from the COSE unprotected header. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cose_curve_id</td><td>The curve ID of the key returned as defined by [COSE (RFC 8152)] (<a href="https://tools.ietf.org/html/rfc8152">https://tools.ietf.org/html/rfc8152</a>) or the IANA COSE registry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_to_hold_x_coord</td><td>Pointer and length into which the X coordinate is put. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_to_hold_y_coord</td><td>Pointer and length into which the Y coordinate is put. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x_coord</td><td>Pointer and length of the returned X coordinate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y_coord</td><td>Pointer and length of the returned Y coordinate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">T_COSE_SUCCESS</td><td>The key was found and is returned. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_UNKNOWN_KEY</td><td>The key identified by <code>key_select</code> or a <code>kid</code> was not found. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_WRONG_TYPE_OF_KEY</td><td>The key was found, but it was the wrong type for the operation. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_FAIL</td><td>General unspecific failure. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_KEY_BUFFER_SIZE</td><td><a class="el" href="classBuffer.html">Buffer</a> to hold the output was too small.</td></tr>
  </table>
  </dd>
</dl>
<p>This finds and returns a public key. Where it looks for the key is dependent on the OS / platform.</p>
<p><a class="el" href="#ae6150872ec64deffbf6841b523209a93">T_COSE_CRYPTO_EC_P256_COORD_SIZE</a> is the size of the X or Y coordinate for the NIST P-256 curve.</p>
<p>See the note in the Detailed Description (the \file comment block) for details on how <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> and <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> are used to return the X and Y coordinates. </p>

</div>
</div>
<a id="ad61c4d5459a7ec7c9a9b1b9beaed91db" name="ad61c4d5459a7ec7c9a9b1b9beaed91db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61c4d5459a7ec7c9a9b1b9beaed91db">&#9670;&#160;</a></span>t_cose_crypto_hash_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> t_cose_crypto_hash_finish </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *</td>          <td class="paramname"><span class="paramname"><em>hash_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf.html">useful_buf</a></td>          <td class="paramname"><span class="paramname"><em>buffer_to_hold_result</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *</td>          <td class="paramname"><span class="paramname"><em>hash_result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish a cryptographic hash. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_ctx</td><td>Pointer to the hash context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer_to_hold_result</td><td>Pointer and length into which the resulting hash is put. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hash_result</td><td>Pointer and length of the resulting hash.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">T_COSE_ERR_HASH_GENERAL_FAIL</td><td>Some general failure of the hash function. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_HASH_BUFFER_SIZE</td><td>The size of the buffer to hold the hash result was too small.</td></tr>
  </table>
  </dd>
</dl>
<p>Call this to complete the hashing operation. If the everything completed correctly, the resulting hash is returned. Note that any errors that occurred during <a class="el" href="#a7630a1ca6c5eb1722ff5356b91acdf92" title="Feed data into a cryptographic hash. Part of the t_cose crypto adaptation layer.">t_cose_crypto_hash_update()</a> are returned here.</p>
<p>See the note in the Detailed Description (the \file comment block) for details on how <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> and <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> are used to return the hash. </p>

</div>
</div>
<a id="ae5f88ad8d0afcd13b47eee3834d65329" name="ae5f88ad8d0afcd13b47eee3834d65329"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f88ad8d0afcd13b47eee3834d65329">&#9670;&#160;</a></span>t_cose_crypto_hash_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> t_cose_crypto_hash_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *</td>          <td class="paramname"><span class="paramname"><em>hash_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>cose_hash_alg_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start cryptographic hash. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_ctx</td><td>Pointer to the hash context that will be initialized. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cose_hash_alg_id</td><td>Algorithm ID that identifies the hash to use. This is from the [IANA COSE Registry] (<a href="https://www.iana.org/assignments/cose/cose.xhtml">https://www.iana.org/assignments/cose/cose.xhtml</a>). As of the creation of this interface no identifiers of only a hash functions have been registered. Signature algorithms that include specification of the hash have been registered, but they are not to be used here. Until hash functions only have been officially registered, some IDs are defined in the proprietary space in <a class="el" href="t__cose__common_8h.html" title="Defines common to all public t_cose interfaces.">t_cose_common.h</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">T_COSE_ERR_UNSUPPORTED_HASH</td><td>The requested algorithm is unknown or unsupported.</td></tr>
    <tr><td class="paramname">T_COSE_ERR_HASH_GENERAL_FAIL</td><td>Some general failure of the hash function</td></tr>
  </table>
  </dd>
</dl>
<p>This initializes the hash context for the particular algorithm. It must be called first. A <code>hash_ctx</code> can be reused if it is reinitialized. </p>

</div>
</div>
<a id="a7630a1ca6c5eb1722ff5356b91acdf92" name="a7630a1ca6c5eb1722ff5356b91acdf92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7630a1ca6c5eb1722ff5356b91acdf92">&#9670;&#160;</a></span>t_cose_crypto_hash_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void t_cose_crypto_hash_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structt__cose__crypto__hash.html">t_cose_crypto_hash</a> *</td>          <td class="paramname"><span class="paramname"><em>hash_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>data_to_hash</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Feed data into a cryptographic hash. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hash_ctx</td><td>Pointer to the hash context in which accumulate the hash. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_to_hash</td><td>Pointer and length of data to feed into hash. The pointer may by <code>NULL</code> in which case no hashing is performed.</td></tr>
  </table>
  </dd>
</dl>
<p>There is no return value. If an error occurs it is remembered in <code>hash_ctx</code> and returned when <a class="el" href="#ad61c4d5459a7ec7c9a9b1b9beaed91db" title="Finish a cryptographic hash. Part of the t_cose crypto adaptation layer.">t_cose_crypto_hash_finish()</a> is called. Once in the error state, this function may be called, but it will not do anything. </p>

</div>
</div>
<a id="a4ab8519436340643fed475dbf7f38c91" name="a4ab8519436340643fed475dbf7f38c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ab8519436340643fed475dbf7f38c91">&#9670;&#160;</a></span>t_cose_crypto_pub_key_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> t_cose_crypto_pub_key_sign </td>
          <td>(</td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>cose_alg_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>key_select</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>hash_to_sign</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf.html">useful_buf</a></td>          <td class="paramname"><span class="paramname"><em>signature_buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a> *</td>          <td class="paramname"><span class="paramname"><em>signature</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform public key signing. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cose_alg_id</td><td>The algorithm to sign with. The IDs are defined in [COSE (RFC 8152)] (<a href="https://tools.ietf.org/html/rfc8152">https://tools.ietf.org/html/rfc8152</a>) or in the [IANA COSE Registry] (<a href="https://www.iana.org/assignments/cose/cose.xhtml">https://www.iana.org/assignments/cose/cose.xhtml</a>). A proprietary ID can also be defined locally (<code>#define</code>) if the needed one hasn't been registered. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_select</td><td>Indicates which key to use to sign. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_to_sign</td><td>The bytes to sign. Typically, a hash of a payload. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_buffer</td><td>Pointer and length of buffer into which the resulting signature is put. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Pointer and length of the signature returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">T_COSE_SUCCESS</td><td>Successfully created the signature. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_SIG_BUFFER_SIZE</td><td>The <code>signature_buffer</code> too small. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_UNSUPPORTED_SIGNING_ALG</td><td>The requested signing algorithm, <code>cose_alg_id</code>, is not supported. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_UNKNOWN_KEY</td><td>The key identified by <code>key_select</code> was not found. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_WRONG_TYPE_OF_KEY</td><td>The key was found, but it was the wrong type. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_INVALID_ARGUMENT</td><td>Some (unspecified) argument was not valid. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_INSUFFICIENT_MEMORY</td><td>Insufficient heap memory. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_FAIL</td><td>General unspecific failure. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_TAMPERING_DETECTED</td><td>Equivalent to <code>PSA_ERROR_TAMPERING_DETECTED</code>.</td></tr>
  </table>
  </dd>
</dl>
<p>This is called to do public key signing. The implementation will vary from one platform / OS to another but should conform to the description here.</p>
<p>The key selection depends on the platform / OS.</p>
<p>See the note in the Detailed Description (the \file comment block) for details on how <code><a class="el" href="structuseful__buf.html">useful_buf</a></code> and <code><a class="el" href="structuseful__buf__c.html">useful_buf_c</a></code> are used to return the signature.</p>
<p>To find out the size of the signature buffer needed, call this with <code>signature_buffer-&gt;ptr</code> <code>NULL</code> and <code>signature_buffer-&gt;len</code> a very large number like <code>UINT32_MAX</code>. The size will be returned in <code>signature-&gt;len</code>. </p>

</div>
</div>
<a id="a6e0826243f262003d07b74e689aeefc8" name="a6e0826243f262003d07b74e689aeefc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e0826243f262003d07b74e689aeefc8">&#9670;&#160;</a></span>t_cose_crypto_pub_key_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="t__cose__common_8h.html#a469580b586841b779bbdc430d3a0dd97">t_cose_err_t</a> t_cose_crypto_pub_key_verify </td>
          <td>(</td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>cose_alg_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>key_select</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>hash_to_verify</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structuseful__buf__c.html">useful_buf_c</a></td>          <td class="paramname"><span class="paramname"><em>signature</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform public key signature verification. Part of the t_cose crypto adaptation layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cose_alg_id</td><td>The algorithm to use for verification. The IDs are defined in [COSE (RFC 8152)] (<a href="https://tools.ietf.org/html/rfc8152">https://tools.ietf.org/html/rfc8152</a>) or in the [IANA COSE Registry] (<a href="https://www.iana.org/assignments/cose/cose.xhtml">https://www.iana.org/assignments/cose/cose.xhtml</a>). A proprietary ID can also be defined locally (<code>#define</code>) if the needed one hasn't been registered. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_select</td><td>Verification key selection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_id</td><td>A key id or <code>NULL_USEFUL_BUF_C</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_to_verify</td><td>The data or hash that is to be verified. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>The signature.</td></tr>
  </table>
  </dd>
</dl>
<p>This verifies that the <code>signature</code> passed in was over the <code>hash_to_verify</code> passed in.</p>
<p>The public key used to verify the signature is selected by the <code>key_id</code> if it is not <code>NULL_USEFUL_BUF_C</code> or the <code>key_select</code> if it is.</p>
<p>The key selected must be, or include, a public key of the correct type for <code>cose_alg_id</code>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">T_COSE_SUCCESS</td><td>The signature is valid </td></tr>
    <tr><td class="paramname">T_COSE_ERR_SIG_VERIFY</td><td>Signature verification failed. For example, the cryptographic operations completed successfully but hash wasn't as expected. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_UNKNOWN_KEY</td><td>The key identified by <code>key_select</code> or a <code>kid</code> was not found. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_WRONG_TYPE_OF_KEY</td><td>The key was found, but it was the wrong type for the operation. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_UNSUPPORTED_SIGNING_ALG</td><td>The requested signing algorithm is not supported. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_INVALID_ARGUMENT</td><td>Some (unspecified) argument was not valid. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_INSUFFICIENT_MEMORY</td><td>Out of heap memory. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_FAIL</td><td>General unspecific failure. </td></tr>
    <tr><td class="paramname">T_COSE_ERR_TAMPERING_DETECTED</td><td>Equivalent to <code>PSA_ERROR_TAMPERING_DETECTED</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_d00fafdb9414f6e624fcf4d73ffde065.html">platform</a></li><li class="navelem"><a class="el" href="dir_a72924067aea8bbead751f11070268f4.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_007a19531d3d09289f9f9c2cf309e91b.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_05e0d8a557d855fa23572451f1c8ea18.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_ca746bf8ecd12d766019f43663efcc0b.html">services</a></li><li class="navelem"><a class="el" href="dir_923835f9769c78775a68e44a6b879543.html">attestation</a></li><li class="navelem"><a class="el" href="dir_7b21a9191e8d2f7f6543909a71e3be35.html">tfm_impl</a></li><li class="navelem"><a class="el" href="dir_a4b7aa45533a9103aefb0614264d6ac4.html">t_cose</a></li><li class="navelem"><a class="el" href="dir_323b101628e551f2af457ad0548e3030.html">src</a></li><li class="navelem"><a class="el" href="t__cose__crypto_8h.html">t_cose_crypto.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
